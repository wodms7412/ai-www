import streamlit as st
import pandas as pd
import random

# --- 🍚 재료 및 데이터 정의 (10가지) ---
# 실제 사용량 순위 데이터는 구하기 어려우므로, 비교를 위해 임의의 '상대적 사용량 점수'를 설정했습니다.
INGREDIENT_DATA = {
    "쌀": {
        "사용량_순위": {"중국": 100, "인도": 95, "인도네시아": 80, "방글라데시": 75, "베트남": 70, "태국": 65, "미얀마": 60, "필리핀": 55, "브라질": 50, "일본": 45},
        "유명_음식": [
            ("볶음밥 (중국)", "밥을 주 재료로 다양한 채소, 고기, 계란 등을 넣고 볶아낸 음식으로, 중국 전역에서 즐겨 먹는 대중적인 식사입니다."),
            ("비리야니 (인도)", "향신료에 재운 고기나 채소를 쌀과 함께 층층이 쌓아 쪄내는 인도의 전통 쌀 요리로, 풍부한 향이 특징입니다."),
            ("스시 (일본)", "식초로 간을 한 밥 위에 신선한 해산물이나 다른 재료를 올려 만드는 일본의 대표적인 음식입니다.")
        ]
    },
    "밀": {
        "사용량_순위": {"중국": 100, "인도": 90, "러시아": 75, "미국": 70, "프랑스": 65, "캐나다": 60, "파키스탄": 55, "터키": 50, "독일": 45, "우크라이나": 40},
        "유명_음식": [
            ("파스타 (이탈리아)", "밀가루와 물로 만든 면을 다양한 소스(토마토, 크림 등)와 함께 버무려 먹는 이탈리아의 주식입니다."),
            ("난 (인도)", "밀가루 반죽을 화덕(탄두르) 벽에 붙여 구워낸 빵으로, 커리와 함께 곁들여 먹는 인도의 대표적인 빵입니다."),
            ("바게트 (프랑스)", "길쭉한 모양의 프랑스 전통 빵으로, 겉은 바삭하고 속은 부드러워 샌드위치나 수프와 함께 즐겨 먹습니다.")
        ]
    },
    "닭고기": {
        "사용량_순위": {"미국": 100, "중국": 90, "브라질": 85, "러시아": 70, "멕시코": 65, "인도": 60, "아르헨티나": 55, "일본": 50, "영국": 45, "독일": 40},
        "유명_음식": [
            ("프라이드치킨 (미국)", "닭고기에 양념을 입혀 기름에 튀겨낸 요리로, 전 세계적으로 사랑받는 미국의 대표적인 간식입니다."),
            ("치킨 티카 마살라 (인도/영국)", "닭고기를 요구르트와 향신료에 재워 구운 후, 크리미한 토마토 소스에 넣어 만든 커리 요리입니다."),
            ("야키토리 (일본)", "닭고기의 여러 부위를 한 입 크기로 썰어 꼬치에 꿰어 구운 일본의 전통 닭꼬치 요리입니다.")
        ]
    },
    "소고기": {
        "사용량_순위": {"미국": 100, "브라질": 95, "중국": 80, "아르헨티나": 75, "호주": 70, "러시아": 65, "멕시코": 60, "캐나다": 55, "프랑스": 50, "독일": 45},
        "유명_음식": [
            ("스테이크 (미국)", "두꺼운 소고기 등심이나 안심 등을 구워내는 서양 요리의 대표주자로, 굽기 정도를 조절해 먹습니다."),
            ("아사도 (아르헨티나)", "커다란 소고기 덩어리를 통째로 오랜 시간 숯불에 구워내는 아르헨티나의 전통 바비큐입니다."),
            ("비프 부르기뇽 (프랑스)", "소고기와 양파, 버섯 등을 레드 와인에 넣고 오랜 시간 푹 끓여낸 프랑스식 스튜입니다.")
        ]
    },
    "돼지고기": {
        "사용량_순위": {"중국": 100, "EU (독일/스페인)": 90, "미국": 85, "베트남": 75, "러시아": 70, "브라질": 65, "필리핀": 60, "일본": 55, "멕시코": 50, "한국": 45},
        "유명_음식": [
            ("바비큐 포크 (미국)", "돼지고기를 낮은 온도에서 긴 시간 훈연하여 부드럽게 만든 미국의 전통 바비큐입니다."),
            ("하몬 (스페인)", "돼지 뒷다리를 소금에 절여 건조 및 숙성시켜 만드는 스페인의 대표적인 생햄입니다."),
            ("삼겹살 (한국)", "돼지 갈비 부위의 살과 지방이 세 겹으로 이루어진 부위를 구워 먹는 한국의 대표적인 외식 메뉴입니다.")
        ]
    },
    "감자": {
        "사용량_순위": {"벨라루스": 100, "폴란드": 90, "러시아": 85, "네덜란드": 80, "독일": 75, "페루": 70, "영국": 65, "미국": 60, "중국": 55, "인도": 50},
        "유명_음식": [
            ("프렌치 프라이 (벨기에)", "감자를 막대 모양으로 썰어 기름에 튀겨 소금으로 간을 한 세계적인 인기 간식입니다."),
            ("매시트 포테이토 (영국)", "감자를 삶아 으깬 후 우유나 버터를 넣어 부드럽게 만든 서양식 요리입니다."),
            ("페루식 포테이토 스튜 (페루)", "다양한 종류의 감자와 고기, 채소 등을 넣어 끓여낸 페루의 전통적인 스튜입니다.")
        ]
    },
    "토마토": {
        "사용량_순위": {"이탈리아": 100, "미국": 90, "스페인": 85, "터키": 80, "이집트": 75, "인도": 70, "중국": 65, "멕시코": 60, "브라질": 55, "그리스": 50},
        "유명_음식": [
            ("피자 (이탈리아)", "밀가루 도우 위에 토마토 소스와 치즈, 각종 토핑을 올려 구워낸 이탈리아의 국민 음식입니다."),
            ("가스파초 (스페인)", "토마토와 오이, 피망 등 신선한 채소를 갈아 차갑게 마시는 스페인 안달루시아 지방의 수프입니다."),
            ("토마토 수프 (전 세계)", "토마토를 주 재료로 하여 끓여 만든 따뜻하거나 차가운 수프로, 전 세계적으로 즐겨 먹는 요리입니다.")
        ]
    },
    "콩 (대두/팥 등)": {
        "사용량_순위": {"중국": 100, "브라질": 95, "미국": 90, "아르헨티나": 80, "인도": 75, "나이지리아": 70, "한국": 65, "일본": 60, "캐나다": 55, "파라과이": 50},
        "유명_음식": [
            ("두부/된장 (한국)", "콩을 가공하여 만든 두부와 발효시켜 만든 장으로, 한국 식탁의 기본이 되는 건강 음식입니다."),
            ("미소시루 (일본)", "콩을 발효시킨 미소를 물에 풀고 두부, 미역 등을 넣어 끓인 일본의 전통 국물 요리입니다."),
            ("페이장 (쿠바/브라질)", "검은 콩을 주 재료로 하여 돼지고기 등과 함께 푹 끓여 밥과 함께 먹는 남미의 콩 스튜입니다.")
        ]
    },
    "고추": {
        "사용량_순위": {"인도": 100, "멕시코": 95, "태국": 90, "한국": 85, "중국": 80, "파키스탄": 75, "인도네시아": 70, "터키": 65, "페루": 60, "헝가리": 55},
        "유명_음식": [
            ("김치/고추장 (한국)", "배추 등 채소를 고춧가루로 양념하여 발효시킨 한국의 대표 음식 및 양념입니다."),
            ("커리 (인도/태국)", "각종 향신료와 고추를 넣어 만든 매콤하고 걸쭉한 소스를 주재료에 곁들여 먹는 요리입니다."),
            ("칠리 콘 카르네 (멕시코)", "다진 고기와 콩, 토마토, 그리고 칠리(고추)를 듬뿍 넣어 끓인 멕시코풍 스튜입니다.")
        ]
    },
    "치즈": {
        "사용량_순위": {"프랑스": 100, "그리스": 95, "이탈리아": 90, "독일": 85, "스위스": 80, "네덜란드": 75, "미국": 70, "덴마크": 65, "영국": 60, "아르헨티나": 55},
        "유명_음식": [
            ("피자/라자냐 (이탈리아)", "모차렐라, 파르메산 등 다양한 치즈를 활용하는 이탈리아의 대표적인 오븐 요리입니다."),
            ("퐁듀 (스위스/프랑스)", "녹인 치즈를 담은 냄비에 빵이나 감자 등을 찍어 먹는 스위스와 프랑스의 전통 요리입니다."),
            ("타르티플레트 (프랑스)", "감자, 베이컨, 양파 위에 르블로숑 치즈를 듬뿍 올려 오븐에 구워낸 사보이 지방의 요리입니다.")
        ]
    }
}

# --- 🚀 Streamlit 앱 메인 함수 ---
def main():
    st.set_page_config(page_title="재료별 국가 사용량 분석", layout="wide")
    st.title("🌎 10가지 재료별 국가 사용량 및 추천 음식 분석")
    st.markdown("---")

    # 1. 재료 선택 위젯
    ingredients = list(INGREDIENT_DATA.keys())
    
    col1, col2 = st.columns([1, 2])
    
    with col1:
        selected_ingredient = st.selectbox(
            "👇 **10가지 재료 중 하나를 선택하세요:**",
            ingredients,
            key="ingredient_select"
        )

    st.markdown("---")
    
    if selected_ingredient:
        data = INGREDIENT_DATA[selected_ingredient]

        # 2. 그래프 영역
        st.header(f"📈 '{selected_ingredient}' 사용량 순위 (상위 10개국)")
        st.caption("🚨 **주의:** 아래 '사용량 점수'는 상대적인 비교를 위해 임의로 설정된 값입니다. 절대적인 소비량이 아닙니다.")
        
        # 딕셔너리를 Pandas DataFrame으로 변환
        sorted_countries = sorted(data["사용량_순위"].items(), key=lambda item: item[1], reverse=True)
        df_data = {
            '나라': [item[0] for item in sorted_countries],
            '사용량 점수': [item[1] for item in sorted_countries]
        }
        df = pd.DataFrame(df_data).set_index('나라')
        
        # 그래프 출력
        st.bar_chart(df, use_container_width=True, height=400)

        st.markdown("---")

        # 3. 유명 음식 추천 및 설명 영역
        st.header(f"🍽️ '{selected_ingredient}'로 만든 가장 유명한 음식 3가지")
        st.markdown(f"선택하신 **{selected_ingredient}**을(를) 활용하는 대표적인 세계 음식입니다:")
        
        # 음식 리스트 출력 (컬럼을 사용해 깔끔하게 정렬)
        food_columns = st.columns(3)
        foods = data["유명_음식"]
        
        for i, (name, description) in enumerate(foods):
            with food_columns[i]:
                # 음식 이름 출력
                st.info(f"**#{i+1}**")
                st.markdown(f"### {name}")
                
                # 음식 설명 추가 (가장 중요한 변경점)
                st.markdown(f"*{description}*")
                
        # 마무리 효과
        if random.random() < 0.5: # 50% 확률로 풍선 효과
            st.balloons()

# 앱 실행
if __name__ == "__main__":
    main()
    
